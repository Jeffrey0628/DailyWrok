- toft中的线程池用法
- 上下文context，一个重要的概念
- ？？？？dmp是什么？
- cpc、cpm、cps
- IndexRetrieval过程：
  - 有一个上下文retrieval_context
  - 首先初始化rc->IndexRetrievalClear
  - callback = AsyncRetrievalMerge
  - 各类资源初始化，建了很多的map
    - request_map
    - clients_map
    - request_struct_map
    - retireval_mgr_map
  - 判断当前广告位的广告已经出够，则调用callback
  - 定义request:
    - 分为ad_retrieval_request;  query_retrieval_request; full_shop_retrieval_request; (cpm/cpc request定义了未初始化)
    - 填充traffic_info
    - 拿redis中的media_info填充；redis没有的话，直接调用callback了
    - 填充request_map中的name_2_request，
      - <pos, <string::RETRIEVAL_IPLIST_SET, RetrievalRequest *>
    - 填充clients_map中的name_2_clients，
      - AccessRetrievalClients是vector<RetrievalClientImp  *>的别名
      - <pos, <string::RETRIEVAL_IPLIST_SET, AccessRetrievalClients *>
      - clients列表是在配置文件中设置好的，向jsf获取到的4个地址，new出来的clients
    - 对于每一个广告位pos，都有可能在map中插入多条数据，属于不同类型
      - 不需要直接retrieval
      - 全店铺retrieval请求构造
      - 视觉定向retrieval
  - InitRetrievalRequest
  - AsyncAccessRetrieval参数
    - pos
    - name_2_clients
    - name_2_retrieval_request
    - cmd_attr
    - calc_result_mgr
    - mixer_context
    - callback
  - adretrieval_mgr -> Init, 主要是初始化对应clients的proxy（new出），四个
  - adretrieval_mgr -> AccessRetrieval
    - 下为参数
    - name_2_clients
    - name_2_retrieval_request
  - 对每个proxy->AsyncAccessRetrieval
    - 回调ParseResponse
  - ParseResponse
    - 每个proxy都对应一个response_，其中存了多个广告
  - 四个Proxy中，存了一个calc_result_mgr_私有变量，是顶层的
- Init中
  - retrieval_client_初始化从ini配置文件中读取clients的别名；实例化 RetrievalClientImp，数量与别名的数量相同
  - 另外所有的
- request_